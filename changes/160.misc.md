Replace black formatting with ruff. Using ruff for linting alongside PyLint. Many issues reported by ruff fixed
